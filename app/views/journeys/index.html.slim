.container
  .row
    h2 Journeys
  .row
    ul
      li = link_to 'New Journey', journeys_new_path
      li = link_to 'New Car', new_car_path
      li = link_to 'Journeys I have taken as Passenger', '?q=passengers'
      li = link_to 'Journeys I have taken as Driver', '?q=drivers'
  .row
    .col-sm-12
      table#journeys
        th Start Date
        th Start Time
        th Pickup Point
        th Dropoff
        th Available Seats
        th Car Plate
        th Price
        th Onboard?
        - @journeys.each do |j|
          tr
            td = j.start_time.strftime('%d %b')
            td = j.start_time.strftime('%H:%M %P')
            td = j.pickup_point
            td = link_to j.dropoff_point, edit_journey_path(j.to_param)
            td = j.available_seats
            td = j.car_plate
            td = j.price     
            td = link_to Driver.check(current_user.email, j) || Passenger.check(current_user.email, j, 'true') ? 'Onboard!' : '', "/passengers/#{j.start_time}/#{j.car_plate}/false", method: :put
            td = link_to 'Join', passengers_path(email: current_user.email, start_time: j.start_time, car_plate: j.car_plate, onboard: true), method: :post
